<html>

<head>
 <title>John Mills</title>
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width">
 <link rel="stylesheet" href="https://iamjohnmills.github.io/journal/assets/site.css" />
 <script src="https://iamjohnmills.github.io/journal/assets/site.js"></script>
</head>

<body>
 <header>
  <div data-toggle-nav="true">
   <svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path fill="#33363F" d="m4 10-.707.707L2.586 10l.707-.707L4 10Zm17 8a1 1 0 1 1-2 0h2ZM8.293 15.707l-5-5 1.414-1.414 5 5-1.414 1.414Zm-5-6.414 5-5 1.414 1.414-5 5-1.414-1.414ZM4 9h10v2H4V9Zm17 7v2h-2v-2h2Zm-7-7a7 7 0 0 1 7 7h-2a5 5 0 0 0-5-5V9Z" />
   </svg> More Articles
  </div>
  <a class="button" href="https://iamjohnmills.github.io/journal/johnmills.rss">
   <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 100 100" xml:space="preserve">
    <path d="M26.258 64.949a8.78 8.78 0 0 0-8.78 8.784 8.782 8.782 0 1 0 17.564 0 8.78 8.78 0 0 0-8.784-8.784z" />
    <path d="M23.536 40.801c-.046 0-.09.006-.135.007v-.007h-3.464v.039a3.437 3.437 0 0 0-3.056 3.344h-.007v6.159h.041a3.43 3.43 0 0 0 3.021 3.002v.039H23.4v-.048c.045.001.09.007.135.007 12.772 0 23.173 10.321 23.311 23.061h-.033v3.464h.039a3.437 3.437 0 0 0 3.344 3.056v.007h6.158v-.041a3.43 3.43 0 0 0 3.002-3.021h.039v-3.464h-.006c-.137-19.657-16.166-35.604-35.853-35.604z" />
    <path d="M83.119 76.403C82.98 43.664 56.308 17.07 23.536 17.07c-.046 0-.09.006-.135.007v-.007h-3.464v.039a3.437 3.437 0 0 0-3.056 3.344h-.007v6.159h.041a3.429 3.429 0 0 0 3.021 3.002v.039H23.4v-.048c.045.001.09.007.135.007 25.857 0 46.902 20.967 47.041 46.792h-.035v3.464h.039a3.437 3.437 0 0 0 3.344 3.056v.007h6.159v-.041a3.43 3.43 0 0 0 3.002-3.021h.039v-3.464h-.005z" />
   </svg> RSS </a>
 </header>
 <main>
  <nav>
   <span>I mostly post minimal experiments, tips, and tricks. Keep up-to-date with me and subscribe to my <a href="https://iamjohnmills.github.io/journal/johnmills.rss" target="_blank">RSS Feed</a></span>
   <a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;d3-orthographic-image&#x2F;">Orthographic Image Projection with D3</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;animated-nav-icon&#x2F;">Animated Nav Menu</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;vector-earth&#x2F;">Vector Earth 3D</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;giftv&#x2F;">GifTV</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;shaders&#x2F;">WebGL shaders</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;n64&#x2F;">Spinning N64 logo</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;chat-bubbles&#x2F;">Chat bubbles</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;canvas-video&#x2F;">Video to canvas</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;90s-shapes&#x2F;">90s abstract shapes</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;equalizer&#x2F;">Animated equalizer</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;synthwave-highway&#x2F;">Synthwave highway</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;plasma&#x2F;">Plasma</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;matrix&#x2F;">Matrix</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;cursor-follow&#x2F;">Follow mouse cursor</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;game-of-life&#x2F;">Game of life</a><a href="https:&#x2F;&#x2F;iamjohnmills.github.io&#x2F;journal&#x2F;create-node&#x2F;">My one-function JS framework</a>
  </nav>
  <section>
   <p>Mar 2023</p>
   <h1>WebGL shaders</h1>
   <p>Here I explore integrating WebGL fragment shaders into a no-dependancy project. The variation of these community-made shaders is impressive mathematically and visually.</p>
   <pre data-code="%3Chtml%3E%0A%20%20%3Chead%3E%0A%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%3E%0A%20%20%20%20%3Cstyle%3E%0A%20%20%20%20%20%20*%20%7B%20box-sizing%3A%20border-box%3B%20%7D%0A%20%20%20%20%20%20html%2Cbody%20%7B%20margin%3A%200%3B%20background%3A%20%23000%3B%20overflow%3A%20hidden%3B%20height%3A%20100%25%3B%20%7D%0A%20%20%20%20%20%20%23root%20%7B%20width%3A%20100%25%3B%20height%3A%20350px%3B%20%7D%0A%20%20%20%20%20%20canvas%20%7B%20width%3A%20100%25%3B%20height%3A%20100%25%3B%20object-fit%3A%20cover%3B%20image-rendering%3A%20pixelated%3B%20%7D%0A%20%20%20%20%20%20.toggles%20%7B%20position%3A%20absolute%3B%20left%3A%2025px%3B%20bottom%3A%2030px%3B%20%7D%0A%20%20%20%20%20%20.toggles%20button%20%7B%20margin%3A%200%205px%3B%20%7D%0A%20%20%20%20%3C%2Fstyle%3E%0A%0A%20%20%20%20%3C!--%20Default%20shaders%20--%3E%0A%20%20%20%20%3Cscript%20id%3D%22fragmentShader%22%20type%3D%22x-shader%2Fx-fragment%22%3E%0A%20%20%20%20%20%20precision%20highp%20float%3B%0A%20%20%20%20%20%20uniform%20vec2%20resolution%3B%0A%20%20%20%20%20%20uniform%20sampler2D%20texture%3B%0A%20%20%20%20%20%20void%20main()%20%7B%0A%20%20%20%20%20%20%20%20vec2%20uv%20%3D%20gl_FragCoord.xy%20%2F%20resolution.xy%3B%0A%20%20%20%20%20%20%20%20gl_FragColor%20%3D%20texture2D(texture%2C%20uv)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%3C%2Fscript%3E%0A%20%20%20%20%3Cscript%20id%3D%22vertexShader%22%20type%3D%22x-shader%2Fx-vertex%22%3E%0A%20%20%20%20%20%20attribute%20vec3%20position%3B%0A%20%20%20%20%20%20void%20main()%20%7B%0A%20%20%20%20%20%20%20%20gl_Position%20%3D%20vec4(position%2C%201.0)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%3C%2Fscript%3E%0A%20%20%20%20%3Cscript%20id%3D%22surfaceVertexShader%22%20type%3D%22x-shader%2Fx-vertex%22%3E%0A%20%20%20%20%20%20attribute%20vec3%20position%3B%0A%20%20%20%20%20%20attribute%20vec2%20surfacePosAttrib%3B%0A%20%20%20%20%20%20varying%20vec2%20surfacePosition%3B%0A%20%20%20%20%20%20void%20main()%20%7B%0A%20%20%20%20%20%20%20%20surfacePosition%20%3D%20surfacePosAttrib%3B%0A%20%20%20%20%20%20%20%20gl_Position%20%3D%20vec4(position%2C%201.0)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%3C%2Fscript%3E%0A%0A%20%20%20%20%3Cscript%3E%0A%20%20%20%20const%20createNode%20%3D%20(options)%20%3D%3E%20%7B%0A%20%20%20%20%20%20const%20node%20%3D%20document.createElement(options.tag)%3B%0A%20%20%20%20%20%20if(options.className)%20node.setAttribute('class'%2Coptions.className)%3B%0A%20%20%20%20%20%20if(options.innerHTML)%20node.innerHTML%20%3D%20options.innerHTML%3B%0A%20%20%20%20%20%20if(options.attributes)%20Object.keys(options.attributes).forEach(key%20%3D%3E%20node.setAttribute(key%2Coptions.attributes%5Bkey%5D))%3B%0A%20%20%20%20%20%20if(options.style)%20Object.keys(options.style).forEach(key%20%3D%3E%20node.style%5Bkey%5D%20%3D%20options.style%5Bkey%5D)%3B%0A%20%20%20%20%20%20if(options.event_listeners)%20Object.keys(options.event_listeners).forEach(key%20%3D%3E%20node.addEventListener(key%2Coptions.event_listeners%5Bkey%5D)%20)%0A%20%20%20%20%20%20if(options.root)%20options.root.appendChild(node)%3B%0A%20%20%20%20%20%20return%20node%3B%0A%20%20%20%20%7D%0A%20%20%20%20class%20App%20%7B%0A%20%20%20%20%20%20constructor()%7B%0A%20%20%20%20%20%20%20%20document.addEventListener('DOMContentLoaded'%2Cthis.handleReady.bind(this))%3B%0A%20%20%20%20%20%20%20%20window.addEventListener('resize'%2Cthis.handleResize.bind(this))%3B%0A%20%20%20%20%20%20%20%20this.resize_timeout%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.active_shader%20%3D%20'noise'%3B%0A%20%20%20%20%20%20%20%20this.quality%20%3D%202%0A%20%20%20%20%20%20%20%20this.gl%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.buffer%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.currentProgram%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.screenProgram%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.vertexPosition%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.screenVertexPosition%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.startTime%20%3D%20Date.now()%3B%0A%20%20%20%20%20%20%20%20this.time%20%3D%200%3B%0A%20%20%20%20%20%20%20%20this.screenWidth%20%3D%200%3B%0A%20%20%20%20%20%20%20%20this.screenHeight%20%3D%200%3B%0A%20%20%20%20%20%20%20%20this.surface%20%3D%20%7B%20centerX%3A%200%2C%20centerY%3A%200%2C%20width%3A%201%2C%20height%3A%201%20%7D%2C%0A%20%20%20%20%20%20%20%20this.frontTarget%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20this.backTarget%20%3D%20null%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20setSurfaceSize()%7B%0A%20%20%20%20%20%20%20%20this.els.canvas.width%20%3D%20window.innerWidth%20%2F%20this.quality%3B%0A%20%20%20%20%20%20%20%20this.els.canvas.height%20%3D%20window.innerHeight%20%2F%20this.quality%3B%0A%20%20%20%20%20%20%20%20this.screenWidth%20%3D%20this.els.canvas.width%3B%0A%20%20%20%20%20%20%20%20this.screenHeight%20%3D%20this.els.canvas.height%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Compute%20Surface%20Corners%0A%20%20%20%20%20%20%20%20this.surface.width%20%3D%20this.surface.height%20*%20this.screenWidth%20%2F%20this.screenHeight%3B%0A%20%20%20%20%20%20%20%20const%20halfWidth%20%3D%20this.surface.width%20*%200.5%3B%0A%20%20%20%20%20%20%20%20const%20halfHeight%20%3D%20this.surface.height%20*%200.5%3B%0A%20%20%20%20%20%20%20%20this.gl.bindBuffer(this.gl.ARRAY_BUFFER%2C%20this.surface.buffer)%3B%0A%20%20%20%20%20%20%20%20this.gl.bufferData(this.gl.ARRAY_BUFFER%2C%20new%20Float32Array(%5B%0A%20%20%20%20%20%20%20%20%20%20this.surface.centerX%20-%20halfWidth%2C%20this.surface.centerY%20-%20halfHeight%2C%0A%20%20%20%20%20%20%20%20%20%20this.surface.centerX%20%2B%20halfWidth%2C%20this.surface.centerY%20-%20halfHeight%2C%0A%20%20%20%20%20%20%20%20%20%20this.surface.centerX%20-%20halfWidth%2C%20this.surface.centerY%20%2B%20halfHeight%2C%0A%20%20%20%20%20%20%20%20%20%20this.surface.centerX%20%2B%20halfWidth%2C%20this.surface.centerY%20-%20halfHeight%2C%0A%20%20%20%20%20%20%20%20%20%20this.surface.centerX%20%2B%20halfWidth%2C%20this.surface.centerY%20%2B%20halfHeight%2C%0A%20%20%20%20%20%20%20%20%20%20this.surface.centerX%20-%20halfWidth%2C%20this.surface.centerY%20%2B%20halfHeight%5D)%2C%20this.gl.STATIC_DRAW)%3B%0A%20%20%20%20%20%20%20%20this.gl.viewport(0%2C%200%2C%20this.els.canvas.width%2C%20this.els.canvas.height)%3B%0A%20%20%20%20%20%20%20%20this.frontTarget%20%3D%20this.createTarget(this.screenWidth%2C%20this.screenHeight)%3B%0A%20%20%20%20%20%20%20%20this.backTarget%20%3D%20this.createTarget(this.screenWidth%2C%20this.screenHeight)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20createTarget(width%2Cheight)%7B%0A%20%20%20%20%20%20%20%20var%20target%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20target.framebuffer%20%3D%20this.gl.createFramebuffer()%3B%0A%20%20%20%20%20%20%20%20target.renderbuffer%20%3D%20this.gl.createRenderbuffer()%3B%0A%20%20%20%20%20%20%20%20target.texture%20%3D%20this.gl.createTexture()%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20up%20framebuffer%0A%20%20%20%20%20%20%20%20this.gl.bindTexture(this.gl.TEXTURE_2D%2C%20target.texture)%3B%0A%20%20%20%20%20%20%20%20this.gl.texImage2D(this.gl.TEXTURE_2D%2C%200%2C%20this.gl.RGBA%2C%20width%2C%20height%2C%200%2C%20this.gl.RGBA%2C%20this.gl.UNSIGNED_BYTE%2C%20null)%3B%0A%20%20%20%20%20%20%20%20this.gl.texParameteri(this.gl.TEXTURE_2D%2C%20this.gl.TEXTURE_WRAP_S%2C%20this.gl.CLAMP_TO_EDGE)%3B%0A%20%20%20%20%20%20%20%20this.gl.texParameteri(this.gl.TEXTURE_2D%2C%20this.gl.TEXTURE_WRAP_T%2C%20this.gl.CLAMP_TO_EDGE)%3B%0A%20%20%20%20%20%20%20%20this.gl.texParameteri(this.gl.TEXTURE_2D%2C%20this.gl.TEXTURE_MAG_FILTER%2C%20this.gl.NEAREST)%3B%0A%20%20%20%20%20%20%20%20this.gl.texParameteri(this.gl.TEXTURE_2D%2C%20this.gl.TEXTURE_MIN_FILTER%2C%20this.gl.NEAREST)%3B%0A%20%20%20%20%20%20%20%20this.gl.bindFramebuffer(this.gl.FRAMEBUFFER%2C%20target.framebuffer)%3B%0A%20%20%20%20%20%20%20%20this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER%2C%20this.gl.COLOR_ATTACHMENT0%2C%20this.gl.TEXTURE_2D%2C%20target.texture%2C%200)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20set%20up%20renderbuffer%0A%20%20%20%20%20%20%20%20this.gl.bindRenderbuffer(this.gl.RENDERBUFFER%2C%20target.renderbuffer)%3B%0A%20%20%20%20%20%20%20%20this.gl.renderbufferStorage(this.gl.RENDERBUFFER%2C%20this.gl.DEPTH_COMPONENT16%2C%20width%2C%20height)%3B%0A%20%20%20%20%20%20%20%20this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER%2C%20this.gl.DEPTH_ATTACHMENT%2C%20this.gl.RENDERBUFFER%2C%20target.renderbuffer)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20clean%20up%0A%20%20%20%20%20%20%20%20this.gl.bindTexture(this.gl.TEXTURE_2D%2C%20null)%3B%0A%20%20%20%20%20%20%20%20this.gl.bindRenderbuffer(this.gl.RENDERBUFFER%2C%20null)%3B%0A%20%20%20%20%20%20%20%20this.gl.bindFramebuffer(this.gl.FRAMEBUFFER%2C%20null)%3B%0A%20%20%20%20%20%20%20%20return%20target%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20createShader(src%2Ctype)%7B%0A%20%20%20%20%20%20%20%20const%20shader%20%3D%20this.gl.createShader(type)%3B%0A%20%20%20%20%20%20%20%20this.gl.shaderSource(shader%2Csrc)%3B%0A%20%20%20%20%20%20%20%20this.gl.compileShader(shader)%3B%0A%20%20%20%20%20%20%20%20return%20shader%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20cacheUniformLocation(program%2C%20label)%20%7B%0A%20%20%20%20%20%20%20%20if%20(program.uniformsCache%20%3D%3D%3D%20undefined)%20program.uniformsCache%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20program.uniformsCache%5Blabel%5D%20%3D%20this.gl.getUniformLocation(program%2C%20label)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20async%20fetchShader(name)%7B%0A%20%20%20%20%20%20%20%20const%20response%20%3D%20await%20fetch(name)%3B%0A%20%20%20%20%20%20%20%20return%20await%20response.text()%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20handleResize(event)%7B%0A%20%20%20%20%20%20%20%20if(this.resize_timeout)%20clearTimeout(this.resize_timeout)%3B%0A%20%20%20%20%20%20%20%20this.resize_timeout%20%3D%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20this.setSurfaceSize()%3B%0A%20%20%20%20%20%20%20%20%7D%2C50)%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20async%20handleReady()%7B%0A%20%20%20%20%20%20%20%20if(this.interval)%20cancelAnimationFrame(this.interval)%3B%0A%0A%20%20%20%20%20%20%20%20this.default_shaders%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20fragment%3A%20document.getElementById('fragmentShader').textContent%2C%0A%20%20%20%20%20%20%20%20%20%20vertex%3A%20document.getElementById('vertexShader').textContent%2C%0A%20%20%20%20%20%20%20%20%20%20surface%3A%20document.getElementById('surfaceVertexShader').textContent%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.custom_shaders%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20noise%3A%20await%20this.fetchShader('shader-noise.frag')%2C%0A%20%20%20%20%20%20%20%20%20%20brains%3A%20await%20this.fetchShader('shader-brains.frag')%2C%0A%20%20%20%20%20%20%20%20%20%20clouds%3A%20await%20this.fetchShader('shader-clouds.frag')%2C%0A%20%20%20%20%20%20%20%20%20%20waves%3A%20await%20this.fetchShader('shader-waves.frag')%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20this.els%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20this.els.root%20%3D%20document.getElementById('root')%3B%0A%20%20%20%20%20%20%20%20this.els.root.innerHTML%20%3D%20%60%60%3B%0A%20%20%20%20%20%20%20%20this.els.buttons%20%3D%20createNode(%7B%20root%3A%20this.els.root%2C%20tag%3A%20%60div%60%2C%20className%3A%20%60toggles%60%20%7D)%3B%0A%20%20%20%20%20%20%20%20for(const%20key%20of%20Object.keys(this.custom_shaders)%20)%7B%0A%20%20%20%20%20%20%20%20%20%20const%20button%20%3D%20createNode(%7B%20root%3A%20this.els.buttons%2C%20tag%3A%20%60button%60%2C%20innerHTML%3A%20key%2C%20event_listeners%3A%20%7B%20click%3A%20event%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(this.active_shader%20!%3D%3D%20key)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.active_shader%20%3D%20key%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.handleReady()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%7D%20%7D%20%7D)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20Initialize%20webgl%0A%20%20%20%20%20%20%20%20this.els.canvas%20%3D%20createNode(%7B%20root%3A%20this.els.root%2C%20tag%3A%20%60canvas%60%20%7D)%0A%20%20%20%20%20%20%20%20this.gl%20%3D%20this.els.canvas.getContext('webgl'%2C%20%7B%20antialias%3A%20false%2C%20depth%3A%20false%2C%20stencil%3A%20false%2C%20premultipliedAlpha%3A%20false%2C%20preserveDrawingBuffer%3A%20true%20%7D)%3B%0A%20%20%20%20%20%20%20%20this.gl.getExtension('OES_standard_derivatives')%3B%0A%20%20%20%20%20%20%20%20this.buffer%20%3D%20this.gl.createBuffer()%3B%0A%20%20%20%20%20%20%20%20this.gl.bindBuffer(this.gl.ARRAY_BUFFER%2C%20this.buffer)%3B%0A%20%20%20%20%20%20%20%20this.gl.bufferData(this.gl.ARRAY_BUFFER%2C%20new%20Float32Array(%5B-1.0%2C-1.0%2C1.0%2C-1.0%2C-1.0%2C1.0%2C1.0%2C-1.0%2C1.0%2C1.0%2C-1.0%2C1.0%5D)%2C%20this.gl.STATIC_DRAW)%3B%0A%20%20%20%20%20%20%20%20this.surface.buffer%20%3D%20this.gl.createBuffer()%3B%0A%20%20%20%20%20%20%20%20this.setSurfaceSize()%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Current%20Program%0A%20%20%20%20%20%20%20%20this.currentProgram%20%3D%20this.gl.createProgram()%3B%20%2F%2F%20if%20(this.currentProgram)%20this.gl.deleteProgram(this.currentProgram)%3B%0A%20%20%20%20%20%20%20%20const%20current_vertex_shader%20%3D%20this.createShader(this.default_shaders.surface%2C%20this.gl.VERTEX_SHADER)%3B%0A%20%20%20%20%20%20%20%20const%20current_fragment_shader%20%3D%20this.createShader(this.custom_shaders%5Bthis.active_shader%5D%2C%20this.gl.FRAGMENT_SHADER)%3B%0A%20%20%20%20%20%20%20%20this.gl.attachShader(this.currentProgram%2C%20current_vertex_shader)%3B%0A%20%20%20%20%20%20%20%20this.gl.attachShader(this.currentProgram%2C%20current_fragment_shader)%3B%0A%20%20%20%20%20%20%20%20this.gl.deleteShader(current_vertex_shader)%3B%0A%20%20%20%20%20%20%20%20this.gl.deleteShader(current_fragment_shader)%3B%0A%20%20%20%20%20%20%20%20this.gl.linkProgram(this.currentProgram)%3B%0A%20%20%20%20%20%20%20%20this.cacheUniformLocation(this.currentProgram%2C'time')%3B%0A%20%20%20%20%20%20%20%20this.cacheUniformLocation(this.currentProgram%2C'mouse')%3B%0A%20%20%20%20%20%20%20%20this.cacheUniformLocation(this.currentProgram%2C'resolution')%3B%0A%20%20%20%20%20%20%20%20this.cacheUniformLocation(this.currentProgram%2C'backbuffer')%3B%0A%20%20%20%20%20%20%20%20this.cacheUniformLocation(this.currentProgram%2C'surfaceSize')%3B%0A%20%20%20%20%20%20%20%20this.gl.useProgram(this.currentProgram)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20initialize%20and%20enable%20the%20vertex%20attribute%20arrays%0A%20%20%20%20%20%20%20%20this.surface.positionAttribute%20%3D%20this.gl.getAttribLocation(this.currentProgram%2C%20'surfacePosAttrib')%3B%0A%20%20%20%20%20%20%20%20this.gl.enableVertexAttribArray(this.surface.positionAttribute)%3B%0A%20%20%20%20%20%20%20%20this.vertexPosition%20%3D%20this.gl.getAttribLocation(this.currentProgram%2C%20'position')%3B%0A%20%20%20%20%20%20%20%20this.gl.enableVertexAttribArray(this.vertexPosition)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Screen%20Program%0A%20%20%20%20%20%20%20%20this.screenProgram%20%3D%20this.gl.createProgram()%3B%0A%20%20%20%20%20%20%20%20var%20screen_vertex_shader%20%3D%20this.createShader(this.default_shaders.vertex%2C%20this.gl.VERTEX_SHADER)%3B%0A%20%20%20%20%20%20%20%20var%20screen_fragment_shader%20%3D%20this.createShader(this.default_shaders.fragment%2C%20this.gl.FRAGMENT_SHADER)%3B%0A%20%20%20%20%20%20%20%20this.gl.attachShader(this.screenProgram%2C%20screen_vertex_shader)%3B%0A%20%20%20%20%20%20%20%20this.gl.attachShader(this.screenProgram%2C%20screen_fragment_shader)%3B%0A%20%20%20%20%20%20%20%20this.gl.deleteShader(screen_vertex_shader)%3B%0A%20%20%20%20%20%20%20%20this.gl.deleteShader(screen_fragment_shader)%3B%0A%20%20%20%20%20%20%20%20this.gl.linkProgram(this.screenProgram)%3B%0A%20%20%20%20%20%20%20%20this.gl.useProgram(this.screenProgram)%3B%0A%20%20%20%20%20%20%20%20this.cacheUniformLocation(this.screenProgram%2C'resolution')%3B%0A%20%20%20%20%20%20%20%20this.cacheUniformLocation(this.screenProgram%2C'texture')%3B%0A%20%20%20%20%20%20%20%20this.screenVertexPosition%20%3D%20this.gl.getAttribLocation(this.screenProgram%2C'position')%3B%0A%20%20%20%20%20%20%20%20this.gl.enableVertexAttribArray(this.screenVertexPosition)%3B%0A%20%20%20%20%20%20%20%20this.interval%20%3D%20window.requestAnimationFrame(this.render.bind(this))%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20async%20render()%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20Set%20uniforms%20for%20custom%20shader%0A%20%20%20%20%20%20%20%20this.time%20%3D%20Date.now()%20-%20this.startTime%3B%0A%20%20%20%20%20%20%20%20this.gl.useProgram(this.currentProgram)%3B%0A%20%20%20%20%20%20%20%20this.gl.uniform1f(this.currentProgram.uniformsCache%5B'time'%5D%2C%20this.time%20%2F%201000)%3B%0A%20%20%20%20%20%20%20%20this.gl.uniform2f(this.currentProgram.uniformsCache%5B'resolution'%5D%2C%20this.screenWidth%2C%20this.screenHeight)%3B%0A%20%20%20%20%20%20%20%20this.gl.uniform1i(this.currentProgram.uniformsCache%5B'backbuffer'%5D%2C%200)%3B%0A%20%20%20%20%20%20%20%20this.gl.uniform2f(this.currentProgram.uniformsCache%5B'surfaceSize'%5D%2C%20this.surface.width%2C%20this.surface.height)%3B%0A%20%20%20%20%20%20%20%20this.gl.bindBuffer(this.gl.ARRAY_BUFFER%2C%20this.surface.buffer)%3B%0A%20%20%20%20%20%20%20%20this.gl.vertexAttribPointer(this.surface.positionAttribute%2C%202%2C%20this.gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%20%20%20%20%20%20%20%20this.gl.bindBuffer(this.gl.ARRAY_BUFFER%2C%20this.buffer)%3B%0A%20%20%20%20%20%20%20%20this.gl.vertexAttribPointer(this.vertexPosition%2C%202%2C%20this.gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%20%20%20%20%20%20%20%20this.gl.activeTexture(this.gl.TEXTURE0)%3B%0A%20%20%20%20%20%20%20%20this.gl.bindTexture(this.gl.TEXTURE_2D%2C%20this.backTarget.texture)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Render%20custom%20shader%20to%20front%20buffer%0A%20%20%20%20%20%20%20%20this.gl.bindFramebuffer(this.gl.FRAMEBUFFER%2C%20this.frontTarget.framebuffer)%3B%0A%20%20%20%20%20%20%20%20this.gl.clear(this.gl.COLOR_BUFFER_BIT%20%7C%20this.gl.DEPTH_BUFFER_BIT)%3B%0A%20%20%20%20%20%20%20%20this.gl.drawArrays(this.gl.TRIANGLES%2C%200%2C%206)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Set%20uniforms%20for%20screen%20shader%0A%20%20%20%20%20%20%20%20this.gl.useProgram(this.screenProgram)%3B%0A%20%20%20%20%20%20%20%20this.gl.uniform2f(this.screenProgram.uniformsCache%5B'resolution'%5D%2C%20this.screenWidth%2C%20this.screenHeight)%3B%0A%20%20%20%20%20%20%20%20this.gl.uniform1i(this.screenProgram.uniformsCache%5B'texture'%5D%2C%201)%3B%0A%20%20%20%20%20%20%20%20this.gl.bindBuffer(this.gl.ARRAY_BUFFER%2C%20this.buffer)%3B%0A%20%20%20%20%20%20%20%20this.gl.vertexAttribPointer(this.screenVertexPosition%2C%202%2C%20this.gl.FLOAT%2C%20false%2C%200%2C%200)%3B%0A%20%20%20%20%20%20%20%20this.gl.activeTexture(this.gl.TEXTURE1)%3B%0A%20%20%20%20%20%20%20%20this.gl.bindTexture(this.gl.TEXTURE_2D%2C%20this.frontTarget.texture)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Render%20front%20buffer%20to%20screen%0A%20%20%20%20%20%20%20%20this.gl.bindFramebuffer(this.gl.FRAMEBUFFER%2C%20null)%3B%0A%20%20%20%20%20%20%20%20this.gl.clear(this.gl.COLOR_BUFFER_BIT%20%7C%20this.gl.DEPTH_BUFFER_BIT)%3B%0A%20%20%20%20%20%20%20%20this.gl.drawArrays(this.gl.TRIANGLES%2C%200%2C%206)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20Swap%20buffers%0A%20%20%20%20%20%20%20%20var%20tmp%20%3D%20this.frontTarget%3B%0A%20%20%20%20%20%20%20%20this.frontTarget%20%3D%20this.backTarget%3B%0A%20%20%20%20%20%20%20%20this.backTarget%20%3D%20tmp%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20rAF%0A%20%20%20%20%20%20%20%20this.interval%20%3D%20window.requestAnimationFrame(this.render.bind(this))%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20const%20app%20%3D%20new%20App()%3B%0A%20%20%20%20%3C%2Fscript%3E%0A%20%20%3C%2Fhead%3E%0A%20%20%3Cbody%3E%0A%20%20%20%20%3Cdiv%20id%3D%22root%22%3E%3C%2Fdiv%3E%0A%20%20%3C%2Fbody%3E%0A%3C%2Fhtml%3E%0A"><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css">
      * { <span class="hljs-attribute">box-sizing</span>: border-box; }
      <span class="hljs-selector-tag">html</span>,<span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">background</span>: <span class="hljs-number">#000</span>; <span class="hljs-attribute">overflow</span>: hidden; <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>; }
      <span class="hljs-selector-id">#root</span> { <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">350px</span>; }
      <span class="hljs-selector-tag">canvas</span> { <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>; <span class="hljs-attribute">object-fit</span>: cover; <span class="hljs-attribute">image-rendering</span>: pixelated; }
      <span class="hljs-selector-class">.toggles</span> { <span class="hljs-attribute">position</span>: absolute; <span class="hljs-attribute">left</span>: <span class="hljs-number">25px</span>; <span class="hljs-attribute">bottom</span>: <span class="hljs-number">30px</span>; }
      <span class="hljs-selector-class">.toggles</span> <span class="hljs-selector-tag">button</span> { <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span>; }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Default shaders --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fragmentShader&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;x-shader/x-fragment&quot;</span>&gt;</span><span class="language-javascript">
      precision highp float;
      uniform vec2 resolution;
      uniform sampler2D texture;
      <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) {
        vec2 uv = gl_FragCoord.<span class="hljs-property">xy</span> / resolution.<span class="hljs-property">xy</span>;
        gl_FragColor = <span class="hljs-title function_">texture2D</span>(texture, uv);
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;vertexShader&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;x-shader/x-vertex&quot;</span>&gt;</span><span class="language-javascript">
      attribute vec3 position;
      <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) {
        gl_Position = <span class="hljs-title function_">vec4</span>(position, <span class="hljs-number">1.0</span>);
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;surfaceVertexShader&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;x-shader/x-vertex&quot;</span>&gt;</span><span class="language-javascript">
      attribute vec3 position;
      attribute vec2 surfacePosAttrib;
      varying vec2 surfacePosition;
      <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) {
        surfacePosition = surfacePosAttrib;
        gl_Position = <span class="hljs-title function_">vec4</span>(position, <span class="hljs-number">1.0</span>);
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">createNode</span> = (<span class="hljs-params">options</span>) =&gt; {
      <span class="hljs-keyword">const</span> node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(options.<span class="hljs-property">tag</span>);
      <span class="hljs-keyword">if</span>(options.<span class="hljs-property">className</span>) node.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;class&#x27;</span>,options.<span class="hljs-property">className</span>);
      <span class="hljs-keyword">if</span>(options.<span class="hljs-property">innerHTML</span>) node.<span class="hljs-property">innerHTML</span> = options.<span class="hljs-property">innerHTML</span>;
      <span class="hljs-keyword">if</span>(options.<span class="hljs-property">attributes</span>) <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(options.<span class="hljs-property">attributes</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> node.<span class="hljs-title function_">setAttribute</span>(key,options.<span class="hljs-property">attributes</span>[key]));
      <span class="hljs-keyword">if</span>(options.<span class="hljs-property">style</span>) <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(options.<span class="hljs-property">style</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> node.<span class="hljs-property">style</span>[key] = options.<span class="hljs-property">style</span>[key]);
      <span class="hljs-keyword">if</span>(options.<span class="hljs-property">event_listeners</span>) <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(options.<span class="hljs-property">event_listeners</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> node.<span class="hljs-title function_">addEventListener</span>(key,options.<span class="hljs-property">event_listeners</span>[key]) )
      <span class="hljs-keyword">if</span>(options.<span class="hljs-property">root</span>) options.<span class="hljs-property">root</span>.<span class="hljs-title function_">appendChild</span>(node);
      <span class="hljs-keyword">return</span> node;
    }
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> {
      <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>){
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">handleReady</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">handleResize</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">resize_timeout</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">active_shader</span> = <span class="hljs-string">&#x27;noise&#x27;</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">quality</span> = <span class="hljs-number">2</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertexPosition</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenVertexPosition</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">time</span> = <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenWidth</span> = <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenHeight</span> = <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span> = { <span class="hljs-attr">centerX</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">centerY</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">1</span> },
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontTarget</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">backTarget</span> = <span class="hljs-literal">null</span>;
      }
      <span class="hljs-title function_">setSurfaceSize</span>(<span class="hljs-params"></span>){
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">quality</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">quality</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenWidth</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenHeight</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span>;
        <span class="hljs-comment">// Compute Surface Corners</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">width</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">height</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenWidth</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenHeight</span>;
        <span class="hljs-keyword">const</span> halfWidth = <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">width</span> * <span class="hljs-number">0.5</span>;
        <span class="hljs-keyword">const</span> halfHeight = <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">height</span> * <span class="hljs-number">0.5</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindBuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">ARRAY_BUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">buffer</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bufferData</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">ARRAY_BUFFER</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>([
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerX</span> - halfWidth, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerY</span> - halfHeight,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerX</span> + halfWidth, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerY</span> - halfHeight,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerX</span> - halfWidth, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerY</span> + halfHeight,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerX</span> + halfWidth, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerY</span> - halfHeight,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerX</span> + halfWidth, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerY</span> + halfHeight,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerX</span> - halfWidth, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">centerY</span> + halfHeight]), <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">STATIC_DRAW</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">viewport</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontTarget</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createTarget</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenWidth</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenHeight</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">backTarget</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createTarget</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenWidth</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenHeight</span>);
      }
      <span class="hljs-title function_">createTarget</span>(<span class="hljs-params">width,height</span>){
        <span class="hljs-keyword">var</span> target = {};
        target.<span class="hljs-property">framebuffer</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">createFramebuffer</span>();
        target.<span class="hljs-property">renderbuffer</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">createRenderbuffer</span>();
        target.<span class="hljs-property">texture</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">createTexture</span>();
        <span class="hljs-comment">// set up framebuffer</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindTexture</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, target.<span class="hljs-property">texture</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">texImage2D</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">RGBA</span>, width, height, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">RGBA</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">UNSIGNED_BYTE</span>, <span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">texParameteri</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_WRAP_S</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">CLAMP_TO_EDGE</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">texParameteri</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_WRAP_T</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">CLAMP_TO_EDGE</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">texParameteri</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_MAG_FILTER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">NEAREST</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">texParameteri</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_MIN_FILTER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">NEAREST</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindFramebuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FRAMEBUFFER</span>, target.<span class="hljs-property">framebuffer</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">framebufferTexture2D</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FRAMEBUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">COLOR_ATTACHMENT0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, target.<span class="hljs-property">texture</span>, <span class="hljs-number">0</span>);
        <span class="hljs-comment">// set up renderbuffer</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindRenderbuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">RENDERBUFFER</span>, target.<span class="hljs-property">renderbuffer</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">renderbufferStorage</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">RENDERBUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">DEPTH_COMPONENT16</span>, width, height);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">framebufferRenderbuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FRAMEBUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">DEPTH_ATTACHMENT</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">RENDERBUFFER</span>, target.<span class="hljs-property">renderbuffer</span>);
        <span class="hljs-comment">// clean up</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindTexture</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindRenderbuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">RENDERBUFFER</span>, <span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindFramebuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FRAMEBUFFER</span>, <span class="hljs-literal">null</span>);
        <span class="hljs-keyword">return</span> target;
      }
      <span class="hljs-title function_">createShader</span>(<span class="hljs-params">src,type</span>){
        <span class="hljs-keyword">const</span> shader = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">createShader</span>(type);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">shaderSource</span>(shader,src);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">compileShader</span>(shader);
        <span class="hljs-keyword">return</span> shader;
      }
      <span class="hljs-title function_">cacheUniformLocation</span>(<span class="hljs-params">program, label</span>) {
        <span class="hljs-keyword">if</span> (program.<span class="hljs-property">uniformsCache</span> === <span class="hljs-literal">undefined</span>) program.<span class="hljs-property">uniformsCache</span> = {};
        program.<span class="hljs-property">uniformsCache</span>[label] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">getUniformLocation</span>(program, label);
      }
      <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchShader</span>(<span class="hljs-params">name</span>){
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(name);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>();
      }
      <span class="hljs-title function_">handleResize</span>(<span class="hljs-params">event</span>){
        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">resize_timeout</span>) <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">resize_timeout</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">resize_timeout</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setSurfaceSize</span>();
        },<span class="hljs-number">50</span>);
      }
      <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleReady</span>(<span class="hljs-params"></span>){
        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">interval</span>) <span class="hljs-title function_">cancelAnimationFrame</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">interval</span>);

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">default_shaders</span> = {
          <span class="hljs-attr">fragment</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;fragmentShader&#x27;</span>).<span class="hljs-property">textContent</span>,
          <span class="hljs-attr">vertex</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;vertexShader&#x27;</span>).<span class="hljs-property">textContent</span>,
          <span class="hljs-attr">surface</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;surfaceVertexShader&#x27;</span>).<span class="hljs-property">textContent</span>,
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">custom_shaders</span> = {
          <span class="hljs-attr">noise</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchShader</span>(<span class="hljs-string">&#x27;shader-noise.frag&#x27;</span>),
          <span class="hljs-attr">brains</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchShader</span>(<span class="hljs-string">&#x27;shader-brains.frag&#x27;</span>),
          <span class="hljs-attr">clouds</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchShader</span>(<span class="hljs-string">&#x27;shader-clouds.frag&#x27;</span>),
          <span class="hljs-attr">waves</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchShader</span>(<span class="hljs-string">&#x27;shader-waves.frag&#x27;</span>),
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span> = {};
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">root</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">root</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">``</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">buttons</span> = <span class="hljs-title function_">createNode</span>({ <span class="hljs-attr">root</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">root</span>, <span class="hljs-attr">tag</span>: <span class="hljs-string">`div`</span>, <span class="hljs-attr">className</span>: <span class="hljs-string">`toggles`</span> });
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">custom_shaders</span>) ){
          <span class="hljs-keyword">const</span> button = <span class="hljs-title function_">createNode</span>({ <span class="hljs-attr">root</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">buttons</span>, <span class="hljs-attr">tag</span>: <span class="hljs-string">`button`</span>, <span class="hljs-attr">innerHTML</span>: key, <span class="hljs-attr">event_listeners</span>: { <span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">active_shader</span> !== key){
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">active_shader</span> = key;
              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleReady</span>();
            }
          } } })
        }
        <span class="hljs-comment">// Initialize webgl</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">canvas</span> = <span class="hljs-title function_">createNode</span>({ <span class="hljs-attr">root</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">root</span>, <span class="hljs-attr">tag</span>: <span class="hljs-string">`canvas`</span> })
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">els</span>.<span class="hljs-property">canvas</span>.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;webgl&#x27;</span>, { <span class="hljs-attr">antialias</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">depth</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">stencil</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">premultipliedAlpha</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">preserveDrawingBuffer</span>: <span class="hljs-literal">true</span> });
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">getExtension</span>(<span class="hljs-string">&#x27;OES_standard_derivatives&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">createBuffer</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindBuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">ARRAY_BUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bufferData</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">ARRAY_BUFFER</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>([-<span class="hljs-number">1.0</span>,-<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,-<span class="hljs-number">1.0</span>,-<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,-<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,-<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>]), <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">STATIC_DRAW</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">buffer</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">createBuffer</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setSurfaceSize</span>();
        <span class="hljs-comment">// Current Program</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">createProgram</span>(); <span class="hljs-comment">// if (this.currentProgram) this.gl.deleteProgram(this.currentProgram);</span>
        <span class="hljs-keyword">const</span> current_vertex_shader = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createShader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">default_shaders</span>.<span class="hljs-property">surface</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">VERTEX_SHADER</span>);
        <span class="hljs-keyword">const</span> current_fragment_shader = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createShader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">custom_shaders</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">active_shader</span>], <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FRAGMENT_SHADER</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">attachShader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>, current_vertex_shader);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">attachShader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>, current_fragment_shader);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">deleteShader</span>(current_vertex_shader);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">deleteShader</span>(current_fragment_shader);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">linkProgram</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheUniformLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>,<span class="hljs-string">&#x27;time&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheUniformLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>,<span class="hljs-string">&#x27;mouse&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheUniformLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>,<span class="hljs-string">&#x27;resolution&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheUniformLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>,<span class="hljs-string">&#x27;backbuffer&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheUniformLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>,<span class="hljs-string">&#x27;surfaceSize&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">useProgram</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>);
        <span class="hljs-comment">// initialize and enable the vertex attribute arrays</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">positionAttribute</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">getAttribLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>, <span class="hljs-string">&#x27;surfacePosAttrib&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">enableVertexAttribArray</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">positionAttribute</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertexPosition</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">getAttribLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>, <span class="hljs-string">&#x27;position&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">enableVertexAttribArray</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vertexPosition</span>);
        <span class="hljs-comment">// Screen Program</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">createProgram</span>();
        <span class="hljs-keyword">var</span> screen_vertex_shader = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createShader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">default_shaders</span>.<span class="hljs-property">vertex</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">VERTEX_SHADER</span>);
        <span class="hljs-keyword">var</span> screen_fragment_shader = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createShader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">default_shaders</span>.<span class="hljs-property">fragment</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FRAGMENT_SHADER</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">attachShader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>, screen_vertex_shader);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">attachShader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>, screen_fragment_shader);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">deleteShader</span>(screen_vertex_shader);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">deleteShader</span>(screen_fragment_shader);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">linkProgram</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">useProgram</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheUniformLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>,<span class="hljs-string">&#x27;resolution&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheUniformLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>,<span class="hljs-string">&#x27;texture&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenVertexPosition</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">getAttribLocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>,<span class="hljs-string">&#x27;position&#x27;</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">enableVertexAttribArray</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenVertexPosition</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">interval</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">render</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
      }
      <span class="hljs-keyword">async</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>){
        <span class="hljs-comment">// Set uniforms for custom shader</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">time</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">useProgram</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">uniform1f</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>.<span class="hljs-property">uniformsCache</span>[<span class="hljs-string">&#x27;time&#x27;</span>], <span class="hljs-variable language_">this</span>.<span class="hljs-property">time</span> / <span class="hljs-number">1000</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">uniform2f</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>.<span class="hljs-property">uniformsCache</span>[<span class="hljs-string">&#x27;resolution&#x27;</span>], <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenWidth</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenHeight</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">uniform1i</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>.<span class="hljs-property">uniformsCache</span>[<span class="hljs-string">&#x27;backbuffer&#x27;</span>], <span class="hljs-number">0</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">uniform2f</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentProgram</span>.<span class="hljs-property">uniformsCache</span>[<span class="hljs-string">&#x27;surfaceSize&#x27;</span>], <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">width</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">height</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindBuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">ARRAY_BUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">buffer</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">vertexAttribPointer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">surface</span>.<span class="hljs-property">positionAttribute</span>, <span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FLOAT</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindBuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">ARRAY_BUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">vertexAttribPointer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vertexPosition</span>, <span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FLOAT</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">activeTexture</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE0</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindTexture</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">backTarget</span>.<span class="hljs-property">texture</span>);
        <span class="hljs-comment">// Render custom shader to front buffer</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindFramebuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FRAMEBUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontTarget</span>.<span class="hljs-property">framebuffer</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">clear</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">COLOR_BUFFER_BIT</span> | <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">DEPTH_BUFFER_BIT</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">drawArrays</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TRIANGLES</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);
        <span class="hljs-comment">// Set uniforms for screen shader</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">useProgram</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">uniform2f</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>.<span class="hljs-property">uniformsCache</span>[<span class="hljs-string">&#x27;resolution&#x27;</span>], <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenWidth</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenHeight</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">uniform1i</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenProgram</span>.<span class="hljs-property">uniformsCache</span>[<span class="hljs-string">&#x27;texture&#x27;</span>], <span class="hljs-number">1</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindBuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">ARRAY_BUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">vertexAttribPointer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">screenVertexPosition</span>, <span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FLOAT</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">activeTexture</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE1</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindTexture</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontTarget</span>.<span class="hljs-property">texture</span>);
        <span class="hljs-comment">// Render front buffer to screen</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">bindFramebuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">FRAMEBUFFER</span>, <span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">clear</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">COLOR_BUFFER_BIT</span> | <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">DEPTH_BUFFER_BIT</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-title function_">drawArrays</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gl</span>.<span class="hljs-property">TRIANGLES</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);
        <span class="hljs-comment">// Swap buffers</span>
        <span class="hljs-keyword">var</span> tmp = <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontTarget</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">frontTarget</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">backTarget</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">backTarget</span> = tmp;
        <span class="hljs-comment">// rAF</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">interval</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">render</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
      }
    }
    <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">App</span>();
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
   <p>I recently became aware of frament shaders exploring the three.js scene, and was heavily inspired by <a href="https://glslsandbox.com/">GLSL Sandbox</a> (made by the creator of three.js) and <a href="https://www.shadertoy.com/">Shadertoy</a>. How they work (I think) is by using a mathematical formula to alter the same buffer of pixel data.</p>
   <p>Disclaimer, almost all of this code is not mine. I first picked a few of my fav shaders and created them as filename.frag files. I then copied public code used for glslsandbox and cleared it out but all the only the essential pieces of code and tidied up the logic into my usual style of coding. Even so, you can see the amount of methods to integrate it is quite a lot.</p>
   <p>The above example reads in the frag files as strings and applies them to a webgl canvas. The glslsandbox code includes boilerplate vertex and fragment shaders needed to apply the custom variants. Using this boilerplate code as a foundation, the custom shaders can be easily swapped out.</p>
   <p><strong>Project Assets</strong></p>
   <table>
    <thead>
     <tr>
      <th style="text-align:left">Asset</th>
      <th style="text-align:left">File</th>
      <th style="text-align:left">Description</th>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td style="text-align:left"><code>shader-noise.frag</code></td>
      <td style="text-align:left"><a href="https://iamjohnmills.github.io/journal/shaders/shader-noise.frag">Download</a></td>
      <td style="text-align:left">Noise fragment shader</td>
     </tr>
     <tr>
      <td style="text-align:left"><code>shader-brains.frag</code></td>
      <td style="text-align:left"><a href="https://iamjohnmills.github.io/journal/shaders/shader-brains.frag">Download</a></td>
      <td style="text-align:left">Brains fragment shader</td>
     </tr>
     <tr>
      <td style="text-align:left"><code>shader-clouds.frag</code></td>
      <td style="text-align:left"><a href="https://iamjohnmills.github.io/journal/shaders/shader-clouds.frag">Download</a></td>
      <td style="text-align:left">Clouds fragment shader</td>
     </tr>
     <tr>
      <td style="text-align:left"><code>shader-waves.frag</code></td>
      <td style="text-align:left"><a href="https://iamjohnmills.github.io/journal/shaders/shader-waves.frag">Download</a></td>
      <td style="text-align:left">Waves fragment shader</td>
     </tr>
    </tbody>
   </table>
   <aside>
    <figure>
     <img src="https://iamjohnmills.github.io/journal/assets/jm-photo-2023.jpg" />
    </figure>
    <p>I'm John Mills, a professional frontend engineer. Here I share my experiences and journeys with all of you. Check out all my projects on <a href="https://github.com/iamjohnmills" target="_blank">Github</a>. Message or connect with me on <a href="https://www.linkedin.com/in/iamjohnmills" target="_blank">LinkedIn</a>. I'm a proud dad of my two daughters, cook sometimes, and am interested in a ton of weird stuff.</p>
   </aside>
  </section>
 </main>
</body>

</html>